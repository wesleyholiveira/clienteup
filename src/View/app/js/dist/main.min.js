angular.module("clienteUp",["ngRoute"]),angular.module("clienteUp").controller("AutenticacaoClienteController",["$rootScope","$scope","$location",function(e,t,a){e.logado===!1&&a.path("/sem-autorizacao")}]),angular.module("clienteUp").controller("BuscaController",["$rootScope","$filter","$routeParams","jQueryFactory",function(e,t,a,n){e.matches=!1;var o=[{id:1,nomeEmpresa:"Maná WEB"},{id:2,nomeEmpresa:"Savegnago"},{id:3,nomeEmpresa:"Cojiba"},{id:4,nomeEmpresa:"Usinas Chemicas"},{id:5,nomeEmpresa:"Orto Center"},{id:6,nomeEmpresa:"Docelar Presentes"},{id:7,nomeEmpresa:"Maran Calçados"},{id:8,nomeEmpresa:"Manázius"}];void 0!==a.q&&(e.busca=a.q,e.hasMatches()),e.hasMatches=function(){void 0!==e.busca&&e.busca.length>3?(e.empresas=t("filter")(o,e.busca),e.matches=e.empresas.length):""===e.busca&&(e.matches=!1),$("html, body").animate({scrollTop:0},500)},e.limparBusca=function(){e.busca="",e.matches=!1,e.loader=!1}}]),angular.module("clienteUp").controller("CadastrarController",["$rootScope","$scope","$location","$timeout","$filter","jQueryFactory","clienteAPI","cepAPI",function(e,t,a,n,o,s,r,i){var l=e.storage;t.status=void 0,$('[name^="CPF"]').mask("000.000.000-00"),$('[name^="CEP"]').mask("00000-000"),$('[name^="telefone"]').mask("(00) 0000-0000D",{translation:{D:{pattern:/[0-9]/,optional:!0}}}),t.buscarCEP=function(e){e=o("sanitize")(e),i.getInfos(e).then(function(e){var a=e.data;a.error!==!0?(t.cadastro.cidade=a.localidade,t.cadastro.endereco=a.logradouro):(t.status=!1,t.mensagem="CEP não encontrado.")})},t.cadastrar=function(){r.cadastrar(t.cadastro).then(function(e){t.status=!0,t.mensagem="Cliente cadastrado com sucesso!",r.autenticar(t.cadastro).then(function(e){var t=e.data.mensagem;l.setItem("acessoToken",t),n(function(){return t?void a.path("/cliente/pesquisa"):(a.path("/sem-autorizacao"),!1)},1e3)})},function(e){t.status=!1,t.mensagem=e}),$("html, body").animate({scrollTop:0},500)}}]),angular.module("clienteUp").controller("CuponsController",["$scope","cupomAPI","paths",function(e,t,a){a.img+"/dist";t.listar().then(function(t){e.cupons=t.data},function(e){console.log(e)})}]),angular.module("clienteUp").controller("LoginController",["$rootScope","$scope","$location","clienteAPI",function(e,t,a,n){var o=sessionStorage;t.status=void 0,e.logado===!0&&a.path("/cliente/meus-pontos"),t.enviar=function(){n.autenticar(t.login).then(function(n){t.status=void 0;var s=n.data.mensagem,r=n.data.cliente;o.setItem("acessoToken",s),o.setItem("dadosCliente",r),e.logado=!0,e.cliente=JSON.parse(r),e.cliente.senha="",a.path("/cliente/meus-pontos")},function(a){t.status=!1,e.logado=!1,t.mensagem=a})}}]),angular.module("clienteUp").controller("MeusPontosController",["$scope",function(e){e.meusPontos=[]}]),angular.module("clienteUp").controller("PesquisaController",["$scope","$timeout","clienteAPI",function(e,t,a){e.enviar=function(){a.cadastrarPesquisa(e.pesquisa).then(function(t){e.status=!0,e.mensagem="Pesquisa realizada com sucesso!"},function(t){e.status=!1,e.mensagem=t})}}]),angular.module("clienteUp").controller("PrincipalController",["$rootScope","$scope","$location","jQueryFactory",function(e,t,a,n){var o="Carregando...";e.logado=sessionStorage.getItem("acessoToken")||!1,e.cliente=sessionStorage.getItem("dadosCliente")||!1,e.cliente!==!1&&(e.cliente=JSON.parse(e.cliente),e.cliente.senha=""),e.loading=o,t.topo=function(){$("html, body").animate({scrollTop:0},500)},t.limparLoader=function(){e.loading=o,e.loader=!1},t.sair=function(){sessionStorage.setItem("acessoToken",""),e.logado=!1,e.cliente=!1,a.path("/")}}]);const root="src/View/app",baseUrl=window.location.origin;angular.module("clienteUp").constant("paths",{root:root,js:root+"/js",css:root+"/css",img:root+"/img",templates:root+"/templates",apiURL:"http://localhost/clienteup/app.php"}),angular.module("clienteUp").config(["$httpProvider",function(e){e.interceptors.push("loaderInterceptor")}]),angular.module("clienteUp").config(["$routeProvider","$locationProvider","paths",function(e,t,a){const n=a.templates+"/dist/";e.when("/",{templateUrl:n+"index.html"}).when("/busca",{templateUrl:n+"index.html",controller:"BuscaController"}).when("/como-funciona",{templateUrl:n+"como-funciona.html"}).when("/cliente/meus-pontos",{templateUrl:n+"meus-pontos.html"}).when("/cliente/cadastrar",{templateUrl:n+"cadastrar.html"}).when("/cliente/login",{templateUrl:n+"login.html"}).when("/cliente/pesquisa",{templateUrl:n+"pesquisa.html"}).when("/cliente/pos-venda",{templateUrl:n+"pos-venda.html"}).when("/termos-de-uso",{templateUrl:n+"termos-uso.html"}).when("/brindes",{templateUrl:n+"brindes.html"}).when("/vale-presente",{templateUrl:n+"vale-presente.html"}).when("/sobre-nos",{templateUrl:n+"sobre-nos.html"}).when("/imprensa",{templateUrl:n+"imprensa.html"}).when("/sem-autorizacao",{templateUrl:n+"sem-autorizacao.html"}).when("/404",{templateUrl:n+"404.html"}).otherwise({redirectTo:"/404"})}]),angular.module("clienteUp").factory("jQueryFactory",["$window",function(e){return e.$}]),angular.module("clienteUp").filter("sanitize",function(){return function(e){return e.replace(/\D/g,"")}}),angular.module("clienteUp").factory("loaderInterceptor",["$q","$rootScope","$httpParamSerializer","$location",function(e,t,a,n){return{request:function(e){if(e.url.indexOf("clienteup")>0){var o=/[cliente|empresa]/,s=n.path();s=s.split("/");var r=s.length,i=s[r-2],l=s[r-1];void 0!==i&&o.test(i)&&"login"!==l&&""!==l&&(e.headers["X-Authorization"]=sessionStorage.getItem("acessoToken"))}return"POST"===e.method&&(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.transformRequest=function(e){return a(e)}),t.loader=!0,e},requestError:function(t){return e.reject(t)},response:function(e){return t.loader=!1,e},responseError:function(a){return t.loader=!1,403===a.status&&n.path("/sem-autorizacao"),404===a.status&&n.path("/404"),e.reject("Ocorreu um erro: "+a.data.mensagem+" ["+a.status+"]")}}}]),angular.module("clienteUp").factory("cepAPI",["$http","paths",function(e,t){t.apiURL;return{getInfos:function(t){return e.get("https://viacep.com.br/ws/"+t+"/json/",{cache:!0})}}}]),angular.module("clienteUp").factory("clienteAPI",["$http","paths",function(e,t){const a=t.apiURL;return{cadastrar:function(t){return e.post(a+"/cliente",t)},autenticar:function(t){return e.post(a+"/cliente/login",t)},cadastrarPesquisa:function(t){return e.post(a+"/cliente/pesquisa",t)}}}]),angular.module("clienteUp").factory("cupomAPI",["$http","paths",function(e,t){const a=t.apiURL;return{listar:function(){return e.get(a+"/cupom",{cache:!0})}}}]),+function(e){"use strict";function t(t){var a,n=t.attr("data-target")||(a=t.attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,"");return e(n)}function a(t){return this.each(function(){var a=e(this),o=a.data("bs.collapse"),s=e.extend({},n.DEFAULTS,a.data(),"object"==typeof t&&t);!o&&s.toggle&&/show|hide/.test(t)&&(s.toggle=!1),o||a.data("bs.collapse",o=new n(this,s)),"string"==typeof t&&o[t]()})}var n=function(t,a){this.$element=e(t),this.options=e.extend({},n.DEFAULTS,a),this.$trigger=e('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};n.VERSION="3.3.6",n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(t=o.data("bs.collapse"),t&&t.transitioning))){var s=e.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){o&&o.length&&(a.call(o,"hide"),t||o.data("bs.collapse",null));var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var i=function(){this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return i.call(this);var l=e.camelCase(["scroll",r].join("-"));this.$element.one("bsTransitionEnd",e.proxy(i,this)).emulateTransitionEnd(n.TRANSITION_DURATION)[r](this.$element[0][l])}}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var a=this.dimension();this.$element[a](this.$element[a]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return e.support.transition?void this.$element[a](0).one("bsTransitionEnd",e.proxy(o,this)).emulateTransitionEnd(n.TRANSITION_DURATION):o.call(this)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},n.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(a,n){var o=e(n);this.addAriaAndCollapsedClass(t(o),o)},this)).end()},n.prototype.addAriaAndCollapsedClass=function(e,t){var a=e.hasClass("in");e.attr("aria-expanded",a),t.toggleClass("collapsed",!a).attr("aria-expanded",a)};var o=e.fn.collapse;e.fn.collapse=a,e.fn.collapse.Constructor=n,e.fn.collapse.noConflict=function(){return e.fn.collapse=o,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var o=e(this);o.attr("data-target")||n.preventDefault();var s=t(o),r=s.data("bs.collapse"),i=r?"toggle":o.data();a.call(s,i)})}(jQuery);